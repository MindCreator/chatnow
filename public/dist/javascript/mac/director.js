define(["jquery","template"],function(e,t){function n(){console.log("发起了聊天");var e=t.render("user-tab-tpl",{nickname:"等待中…",face:"/image/who.png",additions:"loading",userClass:"tmp"});$(".user-list").append($(e))}function r(e,n){$(".tab.tmp").remove(),$(".tab.active").removeClass("active"),$(".panel").hide();var e=e,r=t.render("user-tab-tpl",{id:n.id,roomId:e,nickname:n.nickname,face:n.face,desc:n.desc,userClass:"active"}),i=$(r);i.attr("id","tab-"+e),$(".user-list").append(i),r=t.render("panel-tpl",{id:n.id,nickname:n.nickname,face:n.face,desc:n.desc,roomId:e}),i=$(r),i.attr("id","panel-"+e),$(".right-panel").append(i),i.show()}function i(e){$("#tab-"+e).remove(),$("#panel-"+e).remove()}function s(e){$("#tab-"+e).remove(),$("#panel-"+e).remove(),a("admin",{nickname:"抹茶姑娘"},"已经离开房间哦！")}function o(e,t){var e=e,t=t}function u(e,n){var r=t.render("simple-msg-tpl",{color:"blue",nickname:"你",time:(new Date).toLocaleTimeString(),content:n});c(e,r,!0)}function a(e,n,r){var e=e,i=t.render("simple-msg-tpl",{id:n.id,color:"brown",nickname:n.nickname,time:(new Date).toLocaleTimeString(),content:r});c(e,i,!1);if(!$("#tab-"+e).hasClass("active")){var s=$("#tab-"+e).find(".addition");s.addClass("unread");var o=s.html()||0;s.html(parseInt(o)+1)}}function f(e,t,n,r){$(".nickname-"+e).html(t),$(".face-"+e).attr("src",n),$(".desc-"+e).html(r)}function l(){}function c(e,t,n){var r=$("#chat-"+e);r.append($(t)),n&&$("#panel-"+e).find(".po textarea").val(""),r.scrollTop(r[0].scrollHeight-365)}return{join:n,joined:r,leave:i,left:s,send:u,receive:a,profiled:f,profile:l,notice:o}});